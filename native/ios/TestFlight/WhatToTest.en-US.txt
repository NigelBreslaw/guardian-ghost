Tidy up search. Still needs more work.